<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="The Toolkit is an open-source collection of assets that enable application development and support teams to deliver business value quickly using Red Hat OpenShift or Kubernetes"><meta name=author content="Cloud-Native Toolkit development team"><link href=https://operate.cloudnativetoolkit.dev/reference/gitops-structure/ rel=canonical><link rel=icon href=../../images/cloudnativetoolkit.png><meta name=generator content="mkdocs-1.4.2, mkdocs-material-8.5.8"><title>GitOps Structure - Cloud-Native Toolkit: Operate</title><link rel=stylesheet href=../../assets/stylesheets/main.20d9efc8.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.815d1a91.min.css><meta name=theme-color content=#000000><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:300,300i,400,400i,700,700i%7CIBM+Plex+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"IBM Plex Sans";--md-code-font:"IBM Plex Mono"}</style><link rel=stylesheet href=../../css/extra.css><link rel=stylesheet href=../../css/toolkit-code.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-153689700-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");ga("send","event","feedback","click",t,e),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){ga("send","pageview",e.pathname)})});var e=document.createElement("script");e.async=!0,e.src="https://www.google-analytics.com/analytics.js",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><!-- Determine title --><!-- The image needs to have an absolute URL --><!-- Open graph meta tags --><meta property=og:type content=website><meta property=og:title content="Cloud-Native Toolkit: Operate - GitOps Structure"><meta property=og:description content="The Toolkit is an open-source collection of assets that enable application development and support teams to deliver business value quickly using Red Hat OpenShift or Kubernetes"><meta content=https://operate.cloudnativetoolkit.dev/reference/gitops-structure/ property=og:url><meta property=og:image content=https://operate.cloudnativetoolkit.dev/assets/images/banner.png><meta property=og:image:type content=image/png><meta property=og:image:width content=1080><meta property=og:image:height content=568></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=black data-md-color-accent> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#gitops-repository-structure class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Cloud-Native Toolkit: Operate" class="md-header__button md-logo" aria-label="Cloud-Native Toolkit: Operate" data-md-component=logo> <img src=../../images/cloudnativetoolkit.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Cloud-Native Toolkit: Operate </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> GitOps Structure </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/cloud-native-toolkit/site-operator-guide title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <!-- Determine class according to configuration --> <!-- Main navigation --> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <!-- Site title --> <!--
  <label class="md-nav__title" for="__drawer">
    <a
      href="../.."
      title="Cloud-Native Toolkit: Operate"
      class="md-nav__button md-logo"
      aria-label="Cloud-Native Toolkit: Operate"
      data-md-component="logo"
    >
      
  <img src="../../images/cloudnativetoolkit.png" alt="logo">

    </a>
    Cloud-Native Toolkit: Operate
  </label>
--> <!-- Repository information --> <div class=md-nav__source> <a href=https://github.com/cloud-native-toolkit/site-operator-guide title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> </div> </a> </div> <!-- Render item list --> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2> Getting Started <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Getting Started" data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Getting Started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../getting-started/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../getting-started/setup/ class=md-nav__link> Setup </a> </li> <li class=md-nav__item> <a href=../../getting-started/best-practices/ class=md-nav__link> Best practices </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3> Concepts <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Concepts data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Concepts </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../concepts/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../concepts/gitops/ class=md-nav__link> GitOps </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_3 type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3> Toolkit Concepts <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Toolkit Concepts" data-md-level=2> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Toolkit Concepts </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../concepts/module/ class=md-nav__link> Module </a> </li> <li class=md-nav__item> <a href=../../concepts/bom/ class=md-nav__link> Bill of Materials </a> </li> <li class=md-nav__item> <a href=../../concepts/variables/ class=md-nav__link> Configuration data </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4> Tasks <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Tasks data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Tasks </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../tasks/ class=md-nav__link> Overview </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5 type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5> Tutorials <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Tutorials data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Tutorials </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../tutorials/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../tutorials/1-setup/ class=md-nav__link> Setup </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_6 type=checkbox id=__nav_6 checked> <label class=md-nav__link for=__nav_6> Reference <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Reference data-md-level=1> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../module/ class=md-nav__link> Module </a> </li> <li class=md-nav__item> <a href=../bom/ class=md-nav__link> Bill of Material </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> GitOps Structure <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> GitOps Structure </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#app-of-apps class=md-nav__link> App of Apps </a> <nav class=md-nav aria-label="App of Apps"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#argocd-configuration class=md-nav__link> ArgoCD configuration </a> </li> <li class=md-nav__item> <a href=#application-payloads class=md-nav__link> Application "payloads" </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#layered-components class=md-nav__link> Layered components </a> <nav class=md-nav aria-label="Layered components"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#infrastructure class=md-nav__link> Infrastructure </a> </li> <li class=md-nav__item> <a href=#shared-services class=md-nav__link> Shared Services </a> </li> <li class=md-nav__item> <a href=#applications class=md-nav__link> Applications </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#structure class=md-nav__link> Structure </a> <nav class=md-nav aria-label=Structure> <ul class=md-nav__list> <li class=md-nav__item> <a href=#argocd class=md-nav__link> argocd/ </a> </li> <li class=md-nav__item> <a href=#multi-server class=md-nav__link> Multi-server </a> </li> <li class=md-nav__item> <a href=#payload class=md-nav__link> payload/ </a> </li> <li class=md-nav__item> <a href=#configyaml class=md-nav__link> config.yaml </a> </li> <li class=md-nav__item> <a href=#kubeseal_certpem class=md-nav__link> kubeseal_cert.pem </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#example class=md-nav__link> Example </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../glossary/ class=md-nav__link> Glossary </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_7 type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7> Contribute <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Contribute data-md-level=1> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Contribute </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../contribute/ class=md-nav__link> Overview </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_8 type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8> Previous Layout (to be removed once incorporated into the new layout) <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Previous Layout (to be removed once incorporated into the new layout)" data-md-level=1> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Previous Layout (to be removed once incorporated into the new layout) </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_8_1 type=checkbox id=__nav_8_1> <label class=md-nav__link for=__nav_8_1> Learn <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Learn data-md-level=2> <label class=md-nav__title for=__nav_8_1> <span class="md-nav__icon md-icon"></span> Learn </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../learn/ class=md-nav__link> Overview </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_8_1_2 type=checkbox id=__nav_8_1_2> <label class=md-nav__link for=__nav_8_1_2> Create <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Create data-md-level=3> <label class=md-nav__title for=__nav_8_1_2> <span class="md-nav__icon md-icon"></span> Create </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../learn/iascable/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../learn/iascable/lab1/ class=md-nav__link> Lab 1: The basics </a> </li> <li class=md-nav__item> <a href=../../learn/iascable/lab2/ class=md-nav__link> Lab 2: Infrastructure </a> </li> <li class=md-nav__item> <a href=../../learn/iascable/lab3/ class=md-nav__link> Lab 3: GitOps </a> </li> <li class=md-nav__item> <a href=../../learn/iascable/lab4/ class=md-nav__link> Lab 4: Develop GitOps module </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_8_2 type=checkbox id=__nav_8_2> <label class=md-nav__link for=__nav_8_2> Apply <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Apply data-md-level=2> <label class=md-nav__title for=__nav_8_2> <span class="md-nav__icon md-icon"></span> Apply </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../apply/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../apply/bill-of-material-reference/ class=md-nav__link> Bill of Material </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_8_2_3 type=checkbox id=__nav_8_2_3> <label class=md-nav__link for=__nav_8_2_3> Multiple module catalogs <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Multiple module catalogs" data-md-level=3> <label class=md-nav__title for=__nav_8_2_3> <span class="md-nav__icon md-icon"></span> Multiple module catalogs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../apply/multi-catalog/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../apply/multi-catalog/iascable/ class=md-nav__link> Generating automation </a> </li> <li class=md-nav__item> <a href=../../apply/multi-catalog/custom-catalog/ class=md-nav__link> Creating a catalog </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../apply/end-to-end-testing/ class=md-nav__link> End-To-End Testing </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_8_3 type=checkbox id=__nav_8_3> <label class=md-nav__link for=__nav_8_3> Resources <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Resources data-md-level=2> <label class=md-nav__title for=__nav_8_3> <span class="md-nav__icon md-icon"></span> Resources </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../resources/overview/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../resources/ascent/ class=md-nav__link> ASCENT </a> </li> <li class=md-nav__item> <a href=../../resources/automation-bundles/ class=md-nav__link> Automation bundles </a> </li> <li class=md-nav__item> <a href=../../resources/automation-runtimes/ class=md-nav__link> Automation Runtimes </a> </li> <li class=md-nav__item> <a href=../../resources/troubleshooting/ class=md-nav__link> Troubleshooting </a> </li> <li class=md-nav__item> <a href=../../resources/module-catalog/ class=md-nav__link> Module catalog </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#app-of-apps class=md-nav__link> App of Apps </a> <nav class=md-nav aria-label="App of Apps"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#argocd-configuration class=md-nav__link> ArgoCD configuration </a> </li> <li class=md-nav__item> <a href=#application-payloads class=md-nav__link> Application "payloads" </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#layered-components class=md-nav__link> Layered components </a> <nav class=md-nav aria-label="Layered components"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#infrastructure class=md-nav__link> Infrastructure </a> </li> <li class=md-nav__item> <a href=#shared-services class=md-nav__link> Shared Services </a> </li> <li class=md-nav__item> <a href=#applications class=md-nav__link> Applications </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#structure class=md-nav__link> Structure </a> <nav class=md-nav aria-label=Structure> <ul class=md-nav__list> <li class=md-nav__item> <a href=#argocd class=md-nav__link> argocd/ </a> </li> <li class=md-nav__item> <a href=#multi-server class=md-nav__link> Multi-server </a> </li> <li class=md-nav__item> <a href=#payload class=md-nav__link> payload/ </a> </li> <li class=md-nav__item> <a href=#configyaml class=md-nav__link> config.yaml </a> </li> <li class=md-nav__item> <a href=#kubeseal_certpem class=md-nav__link> kubeseal_cert.pem </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#example class=md-nav__link> Example </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/cloud-native-toolkit/site-operator-guide/edit/main/docs/reference/gitops-structure/index.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg> </a> <h1 id=gitops-repository-structure>GitOps Repository Structure<a class=headerlink href=#gitops-repository-structure title="Permanent link">&para;</a></h1> <p><a href=../../concepts/gitops/ >GitOps</a> describes an approach to managing the deployment and maintenance of an environment through configuration stored in a Git repository. However, GitOps does not dictate a particular way the information in the Git repository is organized. There are a number of different tools and approaches available.</p> <p>For the Toolkit, we had defined an opinionated approach to the GitOps repository structure to address complex deployments and take advantage of the capabilities of available GitOps tools. The following gives an overview of this opinionated GitOps repository structure. </p> <h2 id=app-of-apps>App of Apps<a class=headerlink href=#app-of-apps title="Permanent link">&para;</a></h2> <p>There are two major types of resources in the repository:</p> <ol> <li>ArgoCD configuration</li> <li>Application "payloads"</li> </ol> <h3 id=argocd-configuration>ArgoCD configuration<a class=headerlink href=#argocd-configuration title="Permanent link">&para;</a></h3> <p>In ArgoCD, collections of kubernetes resources that are deployed together are called "applications". Applications in ArgoCD are configured using a custom resource definition (CRD) in the cluster which means ArgoCD applications can deploy other ArgoCD applications (called the <a href=https://argoproj.github.io/argo-cd/operator-manual/cluster-bootstrapping/#app-of-apps-pattern>"App of Apps pattern"</a>). With the "App of Apps pattern", the ArgoCD environment can be bootstrapped with an initial application. That initial bootstrap application can then be updated in the GitOps repository to configure other applications.</p> <h3 id=application-payloads>Application "payloads"<a class=headerlink href=#application-payloads title="Permanent link">&para;</a></h3> <p>The ArgoCD configuration points to other paths within the GitOps repository (or various GitOps repositories) that contain the actual "payload" yaml to provision the applications (the deployments, config maps, etc that make up the applications)/</p> <h2 id=layered-components>Layered components<a class=headerlink href=#layered-components title="Permanent link">&para;</a></h2> <p>In addition to separating the ArgoCD configuration from the application "payloads", the configuration has also been divided into three different "layers" of the cluster configuration:</p> <ol> <li>Infrastructure</li> <li>Shared services</li> <li>Applications</li> </ol> <h3 id=infrastructure>Infrastructure<a class=headerlink href=#infrastructure title="Permanent link">&para;</a></h3> <p>Foundational elements within the cluster, like namespaces, service accounts, role-based access control, etc. These resources are often managed by the infrastructure team and are required by the other resources.</p> <h3 id=shared-services>Shared Services<a class=headerlink href=#shared-services title="Permanent link">&para;</a></h3> <p>Shared services are application components that are used across multiple applications or across the cluster. Often these are operator-based services and managed independently from the applications.</p> <h3 id=applications>Applications<a class=headerlink href=#applications title="Permanent link">&para;</a></h3> <p>The application layer contains the applications deployed to the cluster, using the infrastructure and shared service components.</p> <h2 id=structure>Structure<a class=headerlink href=#structure title="Permanent link">&para;</a></h2> <p>Putting it all together, there are seven different locations for the GitOps content:</p> <ol> <li>Bootstrap</li> <li>Infrastructure ArgoCD configuration</li> <li>Shared services ArgoCD configuration</li> <li>Application ArgoCD configuration</li> <li>Infrastructure payload</li> <li>Shared services payload</li> <li>Application payload</li> </ol> <p><img alt="Structure overview" src=https://operate.cloudnativetoolkit.dev/images/gitops-structure-overview.png></p> <p>This repository implements a simple configuration where all seven collections of resources are stored in a single repository. For more complicated deployments, the resources can be separated into different repositories. For example, if the infrastructure, services, and application configuration is managed by different teams then each layer can be managed in a different gitops repository.</p> <h3 id=argocd>argocd/<a class=headerlink href=#argocd title="Permanent link">&para;</a></h3> <p>The <code>argocd/</code> folder contains the ArgoCD application config, separated into the different layer folders:</p> <ul> <li>0-bootstrap</li> <li>1-infrastructure</li> <li>2-services</li> <li>3-applications</li> </ul> <p>The "bootstrap" repository must at least contain the <code>argocd/0-bootstrap</code> folder with the initial configuration. The other layer folders can either be defined in the same repository or separate repositories.</p> <h3 id=multi-server>Multi-server<a class=headerlink href=#multi-server title="Permanent link">&para;</a></h3> <p>The GitOps repository structure supports defining the deployment configuration for multiple servers in a single Git repository. Each of the argocd configuration paths includes a cluster name/identifier so that the full path to the configuration is <code>argocd/{layer}/cluster/{cluster id}</code>, e.g. <code>argocd/0-bootstrap/cluster/default</code>. The default cluster id used is "default". </p> <h3 id=payload>payload/<a class=headerlink href=#payload title="Permanent link">&para;</a></h3> <p>The <code>payload/</code> folder contains the kubernetes resources for the application components for the infrastructure, services, and application layers. These folders can be in the bootstrap repository or any other repository.</p> <h3 id=configyaml>config.yaml<a class=headerlink href=#configyaml title="Permanent link">&para;</a></h3> <p>In order to understand where all the pieces that make up the GitOps deployment can be located, the bootstrap repository contains a yaml file that defines the repository and path for each of the seven locations. This file can be used both by humans to understand the layout and by other tools to place content in the appropriate location. For example:</p> <div class=highlight><pre><span></span><code><span class=nt>bootstrap</span><span class=p>:</span><span class=w></span>
<span class=w>  </span><span class=nt>argocd-config</span><span class=p>:</span><span class=w></span>
<span class=w>    </span><span class=nt>project</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">0-bootstrap</span><span class=w></span>
<span class=w>    </span><span class=nt>repo</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">github.com/cloud-native-toolkit-test/gitops-sample</span><span class=w></span>
<span class=w>    </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/cloud-native-toolkit-test/gitops-sample.git</span><span class=w></span>
<span class=w>    </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">argocd/0-bootstrap</span><span class=w></span>
<span class=nt>infrastructure</span><span class=p>:</span><span class=w></span>
<span class=w>  </span><span class=nt>argocd-config</span><span class=p>:</span><span class=w></span>
<span class=w>    </span><span class=nt>project</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">1-infrastructure</span><span class=w></span>
<span class=w>    </span><span class=nt>repo</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">github.com/cloud-native-toolkit-test/gitops-sample</span><span class=w></span>
<span class=w>    </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/cloud-native-toolkit-test/gitops-sample.git</span><span class=w></span>
<span class=w>    </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">argocd/1-infrastructure</span><span class=w></span>
<span class=w>  </span><span class=nt>payload</span><span class=p>:</span><span class=w></span>
<span class=w>    </span><span class=nt>repo</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">github.com/cloud-native-toolkit-test/gitops-sample</span><span class=w></span>
<span class=w>    </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/cloud-native-toolkit-test/gitops-sample.git</span><span class=w></span>
<span class=w>    </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">payload/1-infrastructure</span><span class=w></span>
<span class=nt>services</span><span class=p>:</span><span class=w></span>
<span class=w>  </span><span class=nt>argocd-config</span><span class=p>:</span><span class=w></span>
<span class=w>    </span><span class=nt>project</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">2-services</span><span class=w></span>
<span class=w>    </span><span class=nt>repo</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">github.com/cloud-native-toolkit-test/gitops-sample</span><span class=w></span>
<span class=w>    </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/cloud-native-toolkit-test/gitops-sample.git</span><span class=w></span>
<span class=w>    </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">argocd/2-services</span><span class=w></span>
<span class=w>  </span><span class=nt>payload</span><span class=p>:</span><span class=w></span>
<span class=w>    </span><span class=nt>repo</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">github.com/cloud-native-toolkit-test/gitops-sample</span><span class=w></span>
<span class=w>    </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/cloud-native-toolkit-test/gitops-sample.git</span><span class=w></span>
<span class=w>    </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">payload/2-services</span><span class=w></span>
<span class=nt>applications</span><span class=p>:</span><span class=w></span>
<span class=w>  </span><span class=nt>argocd-config</span><span class=p>:</span><span class=w></span>
<span class=w>    </span><span class=nt>project</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">3-applications</span><span class=w></span>
<span class=w>    </span><span class=nt>repo</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">github.com/cloud-native-toolkit-test/gitops-sample</span><span class=w></span>
<span class=w>    </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/cloud-native-toolkit-test/gitops-sample.git</span><span class=w></span>
<span class=w>    </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">argocd/3-applications</span><span class=w></span>
<span class=w>  </span><span class=nt>payload</span><span class=p>:</span><span class=w></span>
<span class=w>    </span><span class=nt>repo</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">github.com/cloud-native-toolkit-test/gitops-sample</span><span class=w></span>
<span class=w>    </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/cloud-native-toolkit-test/gitops-sample.git</span><span class=w></span>
<span class=w>    </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">payload/3-applications</span><span class=w></span>
</code></pre></div> <h3 id=kubeseal_certpem>kubeseal_cert.pem<a class=headerlink href=#kubeseal_certpem title="Permanent link">&para;</a></h3> <p>By default, the Toolkit uses <a href=https://github.com/bitnami-labs/sealed-secrets>Sealed Secrets</a> to store encrypted credentials in the GitOps repository. Sealed Secrets works by installing the operator in the cluster and configuring it with a private key. Any credentials are encrypted with the corresponding public cert before storing the value in the GitOps repository. The operator then decrypts the credentials in-cluster and creates the relevant kubernetes Secrets.</p> <p>In order to aid the process, the public certificate that can be used to encrypt additional secrets is stored in repository in the <code>kubeseal_cert.pem</code>.</p> <h2 id=example>Example<a class=headerlink href=#example title="Permanent link">&para;</a></h2> <p>An example GitOps repository is provided at <a href=https://github.com/cloud-native-toolkit-test/gitops-sample>https://github.com/cloud-native-toolkit-test/gitops-sample</a></p> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> </div> </main> <!-- Footer --> <footer class=md-footer> <!-- Further information --> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-column> <div class=md-footer-text><a href=https://modules.cloudnativetoolkit.dev/#/contributing>Contribute</a> to the Toolkit</div> <div class=md-footer-text>Site licensed under <a href=https://creativecommons.org/licenses/by-nc-sa/4.0/ >CC BY-NC-SA 4.0</a></div> </div> <div class=md-footer-column> <div class=md-footer-text>Have questions? open an issue on <a href=https://github.com/cloud-native-toolkit/planning/issues/new/choose>GitHub</a>.</div> <!-- Copyright and theme information --> <div class=md-footer-text> Copyright © 2022 Cloud-Native Toolkit </div> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.instant", "navigation.tracking", "content.tabs.link"], "search": "../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src=../../assets/javascripts/bundle.d6c3db9e.min.js></script> </body> </html>